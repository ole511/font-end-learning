<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>showTime</title>
</head>
<body>
  <select id="year-select">
    <option value="2000">2000</option>
    <option value="2001">2001</option>
    <option value="2002">2002</option>
    <option value="2003">2003</option>
    <option value="2004">2004</option>
    <option value="2005">2005</option>
    <option value="2006">2006</option>
    <option value="2007">2007</option>
    <option value="2008">2008</option>
    <option value="2009">2009</option>
    <option value="2010">2010</option>
    <option value="2011">2011</option>
    <option value="2012">2012</option>
    <option value="2013">2013</option>
    <option value="2014">2014</option>
    <option value="2015">2015</option>
    <option value="2016">2016</option>
    <option value="2017">2017</option>
    <option value="2018">2018</option>
    <option value="2019">2019</option>
    <option value="2020">2020</option>
    <option value="2021">2021</option>
    <option value="2022">2022</option>
    <option value="2023">2023</option>
    <option value="2024">2024</option>
    <option value="2025">2025</option>
    <option value="2026">2026</option>
    <option value="2027">2027</option>
    <option value="2028">2028</option>
    <option value="2029">2029</option>
    <option value="2030">2030</option>
    <option value="2031">2031</option>
    <option value="2032">2032</option>
  </select>

  <select id="month-select">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
  </select>

  <select id="day-select">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
  </select>

  <select id="hour-select">
    <option value="0">00</option>
    <option value="1">01</option>
    <option value="2">02</option>
    <option value="3">03</option>
    <option value="4">04</option>
    <option value="5">05</option>
    <option value="6">06</option>
    <option value="7">07</option>
    <option value="8">08</option>
    <option value="9">09</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
  </select>

  <select id="minute-select">
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
    <option value="32">32</option>
    <option value="33">33</option>
    <option value="34">34</option>
    <option value="35">35</option>
    <option value="36">36</option>
    <option value="37">37</option>
    <option value="38">38</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
    <option value="46">46</option>
    <option value="47">47</option>
    <option value="48">48</option>
    <option value="49">49</option>
    <option value="50">50</option>
    <option value="51">51</option>
    <option value="52">52</option>
    <option value="53">53</option>
    <option value="54">54</option>
    <option value="55">55</option>
    <option value="56">56</option>
    <option value="57">57</option>
    <option value="58">58</option>
    <option value="59">59</option>
  </select>

  <select id="second-select">
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
    <option value="32">32</option>
    <option value="33">33</option>
    <option value="34">34</option>
    <option value="35">35</option>
    <option value="36">36</option>
    <option value="37">37</option>
    <option value="38">38</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
    <option value="46">46</option>
    <option value="47">47</option>
    <option value="48">48</option>
    <option value="49">49</option>
    <option value="50">50</option>
    <option value="51">51</option>
    <option value="52">52</option>
    <option value="53">53</option>
    <option value="54">54</option>
    <option value="55">55</option>
    <option value="56">56</option>
    <option value="57">57</option>
    <option value="58">58</option>
    <option value="59">59</option>
  </select>

  <p id="result-wrapper"></p>
  

<script>
  let yearSelect = document.querySelector("#year-select")
  let monthSelect = document.querySelector("#month-select")
  let daySelect = document.querySelector("#day-select")
  let hourSelect = document.querySelector("#hour-select")
  let minuteSelect = document.querySelector("#minute-select")
  let secondSelect = document.querySelector("#second-select")
  let resultWrapper = document.querySelector("#result-wrapper")

  window.setInterval(timeLeap,1000)
  window.setInterval(adjustDate,100)

  function timeLeap(){
    let nowTime = new Date()
    let selectTime = getSelectTime()
    let difference 
    difference = nowTime - selectTime
    
    if (difference > 0){
      difference = Math.round(difference / 1000)
      let dayDiff = Math.floor(difference / 86400)
      let hourDiff = Math.floor((difference - 86400 * dayDiff)/ 3600)
      let minuteDiff = Math.floor((difference - 86400 * dayDiff - hourDiff * 3600) / 60)
      let secondDiff = difference - 86400 * dayDiff - 3600 * hourDiff - 60 * minuteDiff
      let week = ['星期天','星期一','星期二','星期三','星期四','星期五','星期六']
      resultWrapper.innerHTML = '现在距离' + optionValue(yearSelect) +'年'+optionValue(monthSelect)+'月'+optionValue(daySelect)+'日 '+
      week[selectTime.getDay()] +' '+ optionValue(hourSelect) +':'+optionValue(minuteSelect)+':'+optionValue(secondSelect)+
      ' 已经'+  dayDiff+'天'+minuteDiff+'分'+secondDiff+'秒'
    }
    else{
      difference = Math.round(difference *(-1) / 1000)
      let dayDiff = Math.floor(difference / 86400)
      let hourDiff = Math.floor((difference - 86400 * dayDiff)/ 3600)
      let minuteDiff = Math.floor((difference - 86400 * dayDiff - hourDiff * 3600) / 60)
      let secondDiff = difference - 86400 * dayDiff - 3600 * hourDiff - 60 * minuteDiff
      let week = ['星期天','星期一','星期二','星期三','星期四','星期五','星期六']
      resultWrapper.innerHTML = '现在距离' + optionValue(yearSelect) +'年'+optionValue(monthSelect)+'月'+optionValue(daySelect)+'日 '+
      week[selectTime.getDay()] +' '+ optionValue(hourSelect) +':'+optionValue(minuteSelect)+':'+optionValue(secondSelect)+
      ' 还有'+  dayDiff+'天'+minuteDiff+'分'+secondDiff+'秒'
    }
  }

  function optionValue(selectObject){
    let objectIndex = selectObject.selectedIndex
    return selectObject.options[objectIndex].value
  }

  function getSelectTime(){
    let year = optionValue(yearSelect);
    let month = optionValue(monthSelect) - 1; //月份从0开始计,所以要减一
    let day = optionValue(daySelect);
    let hour = optionValue(hourSelect);
    let minute = optionValue(minuteSelect);
    let second = optionValue(secondSelect);
    let selectedTime = new Date(year, month, day, hour, minute, second);
    return selectedTime;
  }

  function adjustDate(){
    let year = optionValue(yearSelect)
    let month = optionValue(monthSelect)
    let day29 = daySelect.children[28]
    let day30 = daySelect.children[29]
    let day31 = daySelect.children[30]
    switch(month){
      case 1:
      case 3:
      case 5:
      case 7:
      case 8:
      case 10:
      case 12:
        showOption(day29)
        showOption(day30)
        showOption(day31)
        break
      case 2:
        if(isLeapYear(year)){
          showOption(day29)
        }else{
          hideOption(day29)
        }
      case 4:
      case 6:
      case 11:
        hideOption(day31)
        hideOption(day30)
        break
    }
  }

  function showOption(option){
    option.style.display = 'inline'
  }

  function hideOption(option){
    option.style.display = 'none'
  }

  function isLeapYear(num){
    num = Number(num)
    if ((num/4==0 && num/100 != 0) || (num/400 == 0)){
      return true
    }
    else{
      return false
    }
  }


</script>
</body>
</html>
